{"name":"Arduino with frontend JS","tagline":"Connect Arduino input to JS with joystick HID","body":"# Connect Arduino to Webpage with frontend Javascript only\r\nConnect Arduino input to JS with joystick HID\r\n\r\n##Why we need it\r\nThere are tons of ways to connect physical computing stuff to computer via Processing, NodeJs, etc. However there isn't much tutorial on connecting hardware to webpage without using backend scripts. This projects describes a way to provide one way communication from Arduino to browser without running additional scripts. \r\n\r\n##Pros and Cons of this method\r\nPros: Simple to deploy. No need to install anything on computer. No need to learn language other than Javascript.\r\n\r\nCons: One way communication only. Works well on Firefox, Buggy on Chrome, Not functional in Safari. \r\n\r\n##How this works?\r\n\r\nNative [GamePad API](http://www.w3.org/TR/gamepad/) supports readonly access to GamePad. This low level API can access buttons, axes of a gamepad. Since axes are in float format within -1~1 and buttons are in boolean format. We can emulate a Gamepad with Arduino and send values by emulating axes and button actions. Then JavaScript in browser can extract values from the emulated gamepad.\r\n\r\n\r\nAs a demo I used Arduino Leonardo (Any ATmega32u4 based board including Micro/Micro Pro should work) because it has native USB support to emulate a gamepad. However, official Arduino IDE did not provide capability to emulate a gamepad. I found a project [Arduino HID Project](http://github.com/NicoHood/HID) by Nicohood that did all low level stuff on HID and makes this demo pretty simple.\r\n\r\n\r\nYou can either follow [NicoHood's tutorial](http://github.com/NicoHood/HID/wiki) on how to install the library or upload a pre-compiled hex file to Leonardo for a quick test.\r\n\r\n###Write your own code\r\n\r\nMake sure you followed the [install guide](https://github.com/NicoHood/HID/wiki/Installation) and put HID in hardware folder of your sketch book.\r\n\r\nMake sure you chose \"Arduino Leonardo HID-Project\" in Board:\r\n![Arduino Leonardo HID-Project](https://raw.githubusercontent.com/DeqingSun/Arduino_HID_frontendJS/master/tutorial/HID_library_board.png)\r\n\r\n\r\nAnd \"Serial + Gamepad HID\" in USB Core:\r\n![Serial + Gamepad HID](https://raw.githubusercontent.com/DeqingSun/Arduino_HID_frontendJS/master/tutorial/HID_library_board.png)\r\n\r\n\r\nThen you can open \"sketch_forward_input_JS_gamepad/sketch_forward_input_JS_gamepad.ino\" in this repo and upload it to your Leonardo. Also you can modify the code to add your own feature.\r\n\r\n###Upload hex file directly\r\n\r\nIf you want to skip installing the library and only want to try it. There is a sketch_forward_input_JS_gamepad.cpp.hex to use.\r\n\r\n\r\nYou can check both verbose output so you can copy avrdude command from Arduino.\r\n\r\n![verbose output](https://raw.githubusercontent.com/DeqingSun/Arduino_HID_frontendJS/master/tutorial/upload_hex_1.png)\r\n\r\n\r\nCompile and upload any sketch to Leonardo. Find avrdude command in output.\r\n\r\n![Avrdude command](https://raw.githubusercontent.com/DeqingSun/Arduino_HID_frontendJS/master/tutorial/upload_hex_2.png)\r\n\r\n\r\nPaste the command into terminal\r\n\r\n![Paste command](https://raw.githubusercontent.com/DeqingSun/Arduino_HID_frontendJS/master/tutorial/upload_hex_3.png)\r\n\r\n\r\nDelete original hex file path\r\n\r\n![Remove hex](https://raw.githubusercontent.com/DeqingSun/Arduino_HID_frontendJS/master/tutorial/upload_hex_4.png)\r\n\r\nDrag and drop new hex file into terminal\r\n\r\n![new file](https://raw.githubusercontent.com/DeqingSun/Arduino_HID_frontendJS/master/tutorial/upload_hex_5.png)\r\n\r\n\r\nNow you can reset Leonardo and press enter to upload hex file\r\n\r\n![upload](https://raw.githubusercontent.com/DeqingSun/Arduino_HID_frontendJS/master/tutorial/upload_hex_6.png)\r\n\r\n\r\n##Test Gamepad\r\n\r\nNow you should be able to see a functional gamepad. You can use \"Game Controller\" in control panel if you are using Windows.\r\n\r\n![gamepad](https://raw.githubusercontent.com/DeqingSun/Arduino_HID_frontendJS/master/tutorial/working_joystick.png)\r\n\r\n##Wiring\r\n\r\nI used a potentiometer to generate a analog value and buttons to generate digital ones. No pull-up resistor is needed because internal ones are enabled. Just connect buttons between IO and Ground.\r\n\r\n![photo](https://raw.githubusercontent.com/DeqingSun/Arduino_HID_frontendJS/master/test_circuit/Leonardo_test_circuit.jpg)\r\n\r\n![circuit](https://raw.githubusercontent.com/DeqingSun/Arduino_HID_frontendJS/master/test_circuit/Leonardo_test_circuit.png)\r\n\r\n\r\n##Connect it with Browser!\r\n\r\nFirefox is recommended in this step. You can open http://www.html5rocks.com/en/tutorials/doodles/gamepad/ to test if gamepad is recognized.\r\n\r\n![rock](https://raw.githubusercontent.com/DeqingSun/Arduino_HID_frontendJS/master/tutorial/html5rockFirefox.png)\r\n\r\n\r\nIf you want to write your own code, you can refer to simple.html in this repo.\r\n\r\n![simple](https://raw.githubusercontent.com/DeqingSun/Arduino_HID_frontendJS/master/tutorial/connectFirefox.png)\r\n\r\n\r\n\r\n","google":"","note":"Don't delete this file! It's used internally to help with page regeneration."}